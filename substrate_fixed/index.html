<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Fixed-point numbers"><meta name="keywords" content="rust, rustlang, rust-lang, substrate_fixed"><title>substrate_fixed - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../favicon.svg">
<link rel="alternate icon" type="image/png" href="../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../substrate_fixed/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><p class="location">Crate substrate_fixed</p><div class="block version"><p>Version 0.5.6</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all substrate_fixed's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li></ul></div><p class="location"></p><div id="sidebar-vars" data-name="substrate_fixed" data-ty="mod" data-relpath="../"></div></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="">substrate_fixed</a></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/substrate_fixed/lib.rs.html#16-1079" title="goto source code">[src]</a></span></h1><div class="docblock"><h1 id="fixed-point-numbers" class="section-header"><a href="#fixed-point-numbers">Fixed-point numbers</a></h1>
<p>The <a href="https://crates.io/crates/fixed"><em>fixed</em> crate</a> provides fixed-point numbers.</p>
<ul>
<li><a href="struct.FixedI8.html"><code>FixedI8</code></a> and <a href="struct.FixedU8.html"><code>FixedU8</code></a> are eight-bit fixed-point numbers.</li>
<li><a href="struct.FixedI16.html"><code>FixedI16</code></a> and <a href="struct.FixedU16.html"><code>FixedU16</code></a> are 16-bit fixed-point numbers.</li>
<li><a href="struct.FixedI32.html"><code>FixedI32</code></a> and <a href="struct.FixedU32.html"><code>FixedU32</code></a> are 32-bit fixed-point numbers.</li>
<li><a href="struct.FixedI64.html"><code>FixedI64</code></a> and <a href="struct.FixedU64.html"><code>FixedU64</code></a> are 64-bit fixed-point numbers.</li>
<li><a href="struct.FixedI128.html"><code>FixedI128</code></a> and <a href="struct.FixedU128.html"><code>FixedU128</code></a> are 128-bit fixed-point numbers.</li>
</ul>
<p>These types can have <code>Frac</code> fractional bits, where
0 ≤ <code>Frac</code> ≤ <i>n</i> and <i>n</i> is the total number of bits. When
<code>Frac</code> = 0, the fixed-point number behaves like an <i>n</i>-bit
integer. When <code>Frac</code> = <i>n</i>, the value <i>x</i> lies in the range
−0.5 ≤ <i>x</i> &lt; 0.5 for signed numbers, and in the range
0 ≤ <i>x</i> &lt; 1 for unsigned numbers.</p>
<p>Currently the <a href="https://crates.io/crates/typenum"><em>typenum</em> crate</a> is used for the fractional bit count
<code>Frac</code>; it is planned to move to <a href="https://github.com/rust-lang/rust/issues/44580">const generics</a> when they are
supported by the Rust compiler.</p>
<p>The main features are</p>
<ul>
<li>Representation of fixed-point numbers up to 128 bits wide.</li>
<li>Conversions between fixed-point numbers and numeric primitives.</li>
<li>Comparisons between fixed-point numbers and numeric primitives.</li>
<li>Parsing from strings in decimal, binary, octal and hexadecimal.</li>
<li>Display as decimal, binary, octal and hexadecimal.</li>
<li>Arithmetic and logic operations.</li>
</ul>
<p>This crate does <em>not</em> provide general analytic functions.</p>
<ul>
<li>No algebraic functions are provided, for example no <code>sqrt</code> or
<code>pow</code>.</li>
<li>No trigonometric functions are provided, for example no <code>sin</code> or
<code>cos</code>.</li>
<li>No other transcendental functions are provided, for example no
<code>log</code> or <code>exp</code>.</li>
</ul>
<p>These functions are not provided because different implementations can
have different trade-offs, for example trading some correctness for
speed. Implementations can be provided in other crates.</p>
<ul>
<li>The <a href="https://crates.io/crates/fixed-sqrt"><em>fixed-sqrt</em> crate</a> provides the square root operation.</li>
</ul>
<p>The conversions supported cover the following cases.</p>
<ul>
<li>Infallible lossless conversions between fixed-point numbers and
numeric primitives are provided using <a href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html"><code>From</code></a> and <a href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html"><code>Into</code></a>. These
never fail (infallible) and do not lose any bits (lossless).</li>
<li>Infallible lossy conversions between fixed-point numbers and
numeric primitives are provided using the <a href="traits/trait.LossyFrom.html"><code>LossyFrom</code></a> and
<a href="traits/trait.LossyInto.html"><code>LossyInto</code></a> traits. The source can have more fractional bits
than the destination.</li>
<li>Checked conversions between fixed-point numbers and numeric
primitives are provided using the <a href="traits/trait.FromFixed.html"><code>FromFixed</code></a> and <a href="traits/trait.ToFixed.html"><code>ToFixed</code></a>
traits, or using the <a href="struct.FixedI32.html#method.from_num"><code>from_num</code></a> and <a href="struct.FixedI32.html#method.to_num"><code>to_num</code></a> methods and
<a href="struct.FixedI32.html#method.checked_from_num">their checked versions</a>.</li>
<li>Fixed-point numbers can be parsed from decimal strings using
<a href="https://doc.rust-lang.org/nightly/core/str/trait.FromStr.html"><code>FromStr</code></a>, and from binary, octal and hexadecimal strings using
the <a href="struct.FixedI32.html#method.from_str_binary"><code>from_str_binary</code></a>, <a href="struct.FixedI32.html#method.from_str_octal"><code>from_str_octal</code></a> and <a href="struct.FixedI32.html#method.from_str_hex"><code>from_str_hex</code></a>
methods. The result is rounded to the nearest, with ties rounded
to even.</li>
<li>Fixed-point numbers can be converted to strings using <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.Display.html"><code>Display</code></a>,
<a href="https://doc.rust-lang.org/nightly/core/fmt/trait.Binary.html"><code>Binary</code></a>, <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.Octal.html"><code>Octal</code></a>, <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.LowerHex.html"><code>LowerHex</code></a> and <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.UpperHex.html"><code>UpperHex</code></a>. The output
is rounded to the nearest, with ties rounded to even.</li>
</ul>
<h2 id="quick-examples" class="section-header"><a href="#quick-examples">Quick examples</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">substrate_fixed</span>::<span class="ident">types</span>::<span class="ident">I20F12</span>;

<span class="comment">// 19/3 = 6 1/3</span>
<span class="kw">let</span> <span class="ident">six_and_third</span> <span class="op">=</span> <span class="ident">I20F12</span>::<span class="ident">from_num</span>(<span class="number">19</span>) <span class="op">/</span> <span class="number">3</span>;
<span class="comment">// four decimal digits for 12 binary digits</span>
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">six_and_third</span>.<span class="ident">to_string</span>(), <span class="string">&quot;6.3333&quot;</span>);
<span class="comment">// find the ceil and convert to i32</span>
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">six_and_third</span>.<span class="ident">ceil</span>().<span class="ident">to_num</span>::<span class="op">&lt;</span><span class="ident">i32</span><span class="op">&gt;</span>(), <span class="number">7</span>);
<span class="comment">// we can also compare directly to integers</span>
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">six_and_third</span>.<span class="ident">ceil</span>(), <span class="number">7</span>);</pre></div>
<p>The type <a href="types/type.I20F12.html"><code>I20F12</code></a> is a 32-bit fixed-point signed number with 20
integer bits and 12 fractional bits. It is an alias to
<code><a href="struct.FixedI32.html">FixedI32</a>&lt;<a href="types/extra/type.U12.html">U12</a>&gt;</code>. The unsigned
counterpart would be <a href="types/type.U20F12.html"><code>U20F12</code></a>. Aliases are provided for all
combinations of integer and fractional bits adding up to a total of
eight, 16, 32, 64 or 128 bits.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">substrate_fixed</span>::<span class="ident">types</span>::{<span class="ident">I4F4</span>, <span class="ident">I4F12</span>};

<span class="comment">// −8 ≤ I4F4 &lt; 8 with steps of 1/16 (~0.06)</span>
<span class="kw">let</span> <span class="ident">a</span> <span class="op">=</span> <span class="ident">I4F4</span>::<span class="ident">from_num</span>(<span class="number">1</span>);
<span class="comment">// multiplication and division by integers are possible</span>
<span class="kw">let</span> <span class="ident">ans1</span> <span class="op">=</span> <span class="ident">a</span> <span class="op">/</span> <span class="number">5</span> <span class="op">*</span> <span class="number">17</span>;
<span class="comment">// 1 / 5 × 17 = 3 2/5 (3.4), but we get 3 3/16 (~3.2)</span>
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">ans1</span>, <span class="ident">I4F4</span>::<span class="ident">from_bits</span>((<span class="number">3</span> <span class="op">&lt;</span><span class="op">&lt;</span> <span class="number">4</span>) <span class="op">+</span> <span class="number">3</span>));
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">ans1</span>.<span class="ident">to_string</span>(), <span class="string">&quot;3.2&quot;</span>);

<span class="comment">// −8 ≤ I4F12 &lt; 8 with steps of 1/4096 (~0.0002)</span>
<span class="kw">let</span> <span class="ident">wider_a</span> <span class="op">=</span> <span class="ident">I4F12</span>::<span class="ident">from</span>(<span class="ident">a</span>);
<span class="kw">let</span> <span class="ident">wider_ans</span> <span class="op">=</span> <span class="ident">wider_a</span> <span class="op">/</span> <span class="number">5</span> <span class="op">*</span> <span class="number">17</span>;
<span class="kw">let</span> <span class="ident">ans2</span> <span class="op">=</span> <span class="ident">I4F4</span>::<span class="ident">from_num</span>(<span class="ident">wider_ans</span>);
<span class="comment">// now the answer is the much closer 3 6/16 (~3.4)</span>
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">ans2</span>, <span class="ident">I4F4</span>::<span class="ident">from_bits</span>((<span class="number">3</span> <span class="op">&lt;</span><span class="op">&lt;</span> <span class="number">4</span>) <span class="op">+</span> <span class="number">6</span>));
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">ans2</span>.<span class="ident">to_string</span>(), <span class="string">&quot;3.4&quot;</span>);</pre></div>
<p>The second example shows some precision and conversion issues. The low
precision of <code>a</code> means that <code>a / 5</code> is 3⁄16 instead of 1⁄5, leading to
an inaccurate result <code>ans1</code> = 3 3⁄16 (~3.2). With a higher precision,
we get <code>wider_a / 5</code> equal to 819⁄4096, leading to a more accurate
intermediate result <code>wider_ans</code> = 3 1635⁄4096. When we convert back to
four fractional bits, we get <code>ans2</code> = 3 6⁄16 (~3.4).</p>
<p>Note that we can convert from <a href="types/type.I4F4.html"><code>I4F4</code></a> to <a href="types/type.I4F12.html"><code>I4F12</code></a> using <a href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html"><code>From</code></a>, as
the target type has the same number of integer bits and a larger
number of fractional bits. Converting from <a href="types/type.I4F12.html"><code>I4F12</code></a> to <a href="types/type.I4F4.html"><code>I4F4</code></a>
cannot use <a href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html"><code>From</code></a> as we have less fractional bits, so we use
<a href="struct.FixedI32.html#method.from_num"><code>from_num</code></a> instead.</p>
<h2 id="using-the-fixed-crate" class="section-header"><a href="#using-the-fixed-crate">Using the <em>fixed</em> crate</a></h2>
<p>The <em>fixed</em> crate is available on <a href="https://crates.io/crates/fixed">crates.io</a>. To use
it in your crate, add it as a dependency inside <a href="https://doc.rust-lang.org/cargo/guide/dependencies.html"><em>Cargo.toml</em></a>:</p>
<pre><code class="language-toml">[dependencies]
fixed = &quot;0.5.4&quot;
</code></pre>
<p>The <em>fixed</em> crate requires rustc version 1.39.0 or later.</p>
<h2 id="optional-features" class="section-header"><a href="#optional-features">Optional features</a></h2>
<p>The <em>fixed</em> crate has four optional feature:</p>
<ol>
<li><code>az</code>, disabled by default. This implements the cast traits
provided by the <a href="https://crates.io/crates/az"><em>az</em> crate</a>.</li>
<li><code>f16</code>, disabled by default. This provides conversion to/from
<a href="https://docs.rs/half/%5E1/half/struct.f16.html"><code>f16</code></a> and <a href="https://docs.rs/half/%5E1/half/struct.bf16.html"><code>bf16</code></a>. This features requires the <a href="https://crates.io/crates/half"><em>half</em> crate</a>.</li>
<li><code>serde</code>, disabled by default. This provides serialization support
for the fixed-point types. This feature requires the
<a href="https://crates.io/crates/serde"><em>serde</em> crate</a>.</li>
<li><code>std</code>, disabled by default. This is for features that are not
possible under <code>no_std</code>: currently the implementation of the
<a href="https://doc.rust-lang.org/nightly/std/error/trait.Error.html"><code>Error</code></a> trait for <a href="struct.ParseFixedError.html"><code>ParseFixedError</code></a>.</li>
</ol>
<p>To enable features, you can add the dependency like this to
<a href="https://doc.rust-lang.org/cargo/guide/dependencies.html"><em>Cargo.toml</em></a>:</p>
<pre><code class="language-toml">[dependencies.fixed]
version = &quot;0.5.4&quot;
features = [&quot;f16&quot;, &quot;serde&quot;]
</code></pre>
<h2 id="license" class="section-header"><a href="#license">License</a></h2>
<p>This crate is free software: you can redistribute it and/or modify it
under the terms of either</p>
<ul>
<li>the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a> or</li>
<li>the <a href="https://opensource.org/licenses/MIT">MIT License</a></li>
</ul>
<p>at your option.</p>
<h3 id="contribution" class="section-header"><a href="#contribution">Contribution</a></h3>
<p>Unless you explicitly state otherwise, any contribution intentionally
submitted for inclusion in the work by you, as defined in the Apache
License, Version 2.0, shall be dual licensed as above, without any
additional terms or conditions.</p>
</div><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<table><tr class="module-item"><td><a class="mod" href="consts/index.html" title="substrate_fixed::consts mod">consts</a></td><td class="docblock-short"><p>This module contains constants.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="prelude/index.html" title="substrate_fixed::prelude mod">prelude</a></td><td class="docblock-short"><p>A prelude for users of the <em>fixed</em> crate.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="traits/index.html" title="substrate_fixed::traits mod">traits</a></td><td class="docblock-short"><p>This module contains traits.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="transcendental/index.html" title="substrate_fixed::transcendental mod">transcendental</a></td><td class="docblock-short"><p>This module contains transcendental functions.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="types/index.html" title="substrate_fixed::types mod">types</a></td><td class="docblock-short"><p>This module provides type aliases for all supported fixed-point
numbers.</p>
</td></tr></table><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.FixedI8.html" title="substrate_fixed::FixedI8 struct">FixedI8</a></td><td class="docblock-short"><p>An eight-bit fixed-point signed number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FixedI16.html" title="substrate_fixed::FixedI16 struct">FixedI16</a></td><td class="docblock-short"><p>A 16-bit fixed-point signed number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FixedI32.html" title="substrate_fixed::FixedI32 struct">FixedI32</a></td><td class="docblock-short"><p>A 32-bit fixed-point signed number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FixedI64.html" title="substrate_fixed::FixedI64 struct">FixedI64</a></td><td class="docblock-short"><p>A 64-bit fixed-point signed number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FixedI128.html" title="substrate_fixed::FixedI128 struct">FixedI128</a></td><td class="docblock-short"><p>A 128-bit fixed-point signed number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FixedU8.html" title="substrate_fixed::FixedU8 struct">FixedU8</a></td><td class="docblock-short"><p>An eight-bit fixed-point unsigned number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FixedU16.html" title="substrate_fixed::FixedU16 struct">FixedU16</a></td><td class="docblock-short"><p>A 16-bit fixed-point unsigned number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FixedU32.html" title="substrate_fixed::FixedU32 struct">FixedU32</a></td><td class="docblock-short"><p>A 32-bit fixed-point unsigned number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FixedU64.html" title="substrate_fixed::FixedU64 struct">FixedU64</a></td><td class="docblock-short"><p>A 64-bit fixed-point unsigned number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FixedU128.html" title="substrate_fixed::FixedU128 struct">FixedU128</a></td><td class="docblock-short"><p>A 128-bit fixed-point unsigned number with <code>Frac</code> fractional bits.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ParseFixedError.html" title="substrate_fixed::ParseFixedError struct">ParseFixedError</a></td><td class="docblock-short"><p>An error which can be returned when parsing a fixed-point number.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Wrapping.html" title="substrate_fixed::Wrapping struct">Wrapping</a></td><td class="docblock-short"><p>Provides intentionally wrapped arithmetic on fixed-point numbers.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="substrate_fixed" data-search-js="../search-index.js"></div>
    <script src="../main.js"></script></body></html>